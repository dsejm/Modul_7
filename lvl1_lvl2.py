import requests
from bs4 import BeautifulSoup as BS
import numpy as np
import matplotlib.pyplot as plt
from dateutil.parser import parse

headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36", "X-Amzn-Trace-Id": "Root=1-64aafab1-41891f750c5b32c7743ef3c1"}
url = "https://mfd.ru/currency/?currency=USD"
respons = requests.get(url, headers=headers)
soup = BS(respons.text, "html.parser")
data = soup.find("table", class_="mfd-table mfd-currency-table")
curses_ = data.find_all("td")

value = []

for curs in curses_:
    day = curs.text
    day = day.replace("с", "").strip()
    value.append(day)
dates = value[0::3]
price_str = value[1::3]
delta = value[2::3]
price = []
for i in price_str:
    i = float(i)
    price.append(i)
# dates = ['13.07.2023', '12.07.2023', '11.07.2023', '08.07.2023', '07.07.2023', '06.07.2023', '05.07.2023', '04.07.2023', '01.07.2023', '30.06.2023', '29.06.2023', '28.06.2023', '27.06.2023', '24.06.2023', '23.06.2023', '22.06.2023', '21.06.2023', '20.06.2023', '17.06.2023', '16.06.2023', '15.06.2023', '14.06.2023', '10.06.2023', '09.06.2023', '08.06.2023', '07.06.2023', '06.06.2023', '03.06.2023', '02.06.2023', '01.06.2023', '31.05.2023', '30.05.2023', '27.05.2023', '26.05.2023', '25.05.2023', '24.05.2023', '23.05.2023', '20.05.2023', '19.05.2023', '18.05.2023', '17.05.2023', '16.05.2023', '13.05.2023', '12.05.2023', '11.05.2023', '06.05.2023', '05.05.2023', '04.05.2023', '03.05.2023', '29.04.2023', '28.04.2023', '27.04.2023', '26.04.2023', '25.04.2023', '22.04.2023', '21.04.2023', '20.04.2023', '19.04.2023', '18.04.2023', '15.04.2023', '14.04.2023', '13.04.2023', '12.04.2023', '11.04.2023', '08.04.2023', '07.04.2023', '06.04.2023', '05.04.2023', '04.04.2023', '01.04.2023', '31.03.2023', '30.03.2023', '29.03.2023', '28.03.2023', '25.03.2023', '24.03.2023', '23.03.2023', '22.03.2023', '21.03.2023', '18.03.2023', '17.03.2023', '16.03.2023', '15.03.2023', '14.03.2023', '11.03.2023', '10.03.2023', '08.03.2023', '07.03.2023', '04.03.2023', '03.03.2023', '02.03.2023', '01.03.2023', '28.02.2023', '23.02.2023', '22.02.2023', '21.02.2023', '18.02.2023', '17.02.2023', '16.02.2023', '15.02.2023', '14.02.2023', '11.02.2023', '10.02.2023', '09.02.2023', '08.02.2023', '07.02.2023', '04.02.2023', '03.02.2023', '02.02.2023', '01.02.2023', '31.01.2023', '28.01.2023', '27.01.2023', '26.01.2023', '25.01.2023', '24.01.2023', '21.01.2023', '20.01.2023', '19.01.2023', '18.01.2023', '17.01.2023', '14.01.2023', '13.01.2023']
# price = [90.6253, 90.5045, 91.4931, 91.6879, 92.5695, 90.338, 89.545, 89.3255, 88.3844, 87.0341, 85.6192, 85.0504, 84.6642, 84.0793, 83.6077, 84.2467, 84.2336, 83.9866, 83.6498, 83.9611, 84.3249, 83.6405, 82.6417, 82.093, 81.4581, 81.2502, 81.3294, 80.8756, 80.9657, 80.9942, 80.6872, 80.0555, 79.9667, 79.9841, 79.9669, 80.1665, 79.9379, 79.9093, 80.0366, 80.7642, 79.9798, 79.1004, 77.2041, 75.8846, 76.6929, 76.8207, 78.6139, 79.3071, 79.9609, 80.5093, 81.5601, 81.6274, 81.5499, 81.2745, 81.4863, 81.6188, 81.6549, 81.6028, 81.6279, 81.5045, 81.6758, 82.0934, 82.1799, 81.7441, 82.3988, 80.6713, 79.4961, 79.3563, 77.951, 77.3233, 77.0863, 76.9781, 76.5939, 76.5662, 76.4479, 76.3072, 76.9561, 76.8373, 77.2422, 76.6044, 76.4095, 75.7457, 75.1927, 75.4609, 75.9406, 75.9028, 75.4577, 75.4728, 75.4592, 75.4729, 75.2513, 74.8932, 75.4323, 74.7087, 74.8596, 74.0432, 74.7588, 74.7638, 74.2077, 73.8645, 73.6307, 72.7923, 72.8949, 71.5763, 70.8924, 70.5991, 70.3847, 70.0414, 70.1217, 70.5174, 69.5927, 69.3372, 69.1263, 68.9573, 68.7529, 68.6288, 68.6656, 68.8467, 68.8728, 68.6644, 68.2892, 67.5744, 67.7775]
# delta = ['+0.1208', '−0.9886', '−0.1948', '−0.8816', '+2.2315', '+0.793', '+0.2195', '+0.9411', '+1.3503', '+1.4149', '+0.5688', '+0.3862', '+0.5849', '+0.4716', '−0.639', '+0.0131', '+0.247', '+0.3368', '−0.3113', '−0.3638', '+0.6844', '+0.9988', '+0.5487', '+0.6349', '+0.2079', '−0.0792', '+0.4538', '−0.0901', '−0.0285', '+0.307', '+0.6317', '+0.0888', '−0.0174', '+0.0172', '−0.1996', '+0.2286', '+0.0286', '−0.1273', '−0.7276', '+0.7844', '+0.8794', '+1.8963', '+1.3195', '−0.8083', '−0.1278', '−1.7932', '−0.6932', '−0.6538', '−0.5484', '−1.0508', '−0.0673', '+0.0775', '+0.2754', '−0.2118', '−0.1325', '−0.0361', '+0.0521', '−0.0251', '+0.1234', '−0.1713', '−0.4176', '−0.0865', '+0.4358', '−0.6547', '+1.7275', '+1.1752', '+0.1398', '+1.4053', '+0.6277', '+0.237', '+0.1082', '+0.3842', '+0.0277', '+0.1183', '+0.1407', '−0.6489', '+0.1188', '−0.4049', '+0.6378', '+0.1949', '+0.6638', '+0.553', '−0.2682', '−0.4797', '+0.0378', '+0.4451', '−0.0151', '+0.0136', '−0.0137', '+0.2216', '+0.3581', '−0.5391', '+0.7236', '−0.1509', '+0.8164', '−0.7156', '−0.005', '+0.5561', '+0.3432', '+0.2338', '+0.8384', '−0.1026', '+1.3186', '+0.6839', '+0.2933', '+0.2144', '+0.3433', '−0.0803', '−0.3957', '+0.9247', '+0.2555', '+0.2109', '+0.169', '+0.2044', '+0.1241', '−0.0368', '−0.1811', '−0.0261', '+0.2084', '+0.3752', '+0.7148', '−0.2031', '−1.2427']
dates = dates[::-1]
price = price[::-1]
delta = delta[::-1]
dates_1 = []
for date in dates:
    dt = (parse(date))
    dates_1.append(dt.date())

print(dates_1)
print(price)
print(delta)
y = np.array(price)
x = np.array(dates_1)
plt.plot(x, y)
plt.show()
